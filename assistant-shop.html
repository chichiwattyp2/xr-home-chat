<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Assistant + Shop (Staging)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- A-Frame core + env -->
  <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-environment-component@1.3.1/dist/aframe-environment-component.min.js"></script>
  <!-- Our reusable components -->
  <script src="js/assistant-shop.js" defer></script>
  <style>html,body{margin:0;height:100%;background:#000}</style>
</head>
  
<body>
  <!-- MR Overlay UI (stays pinned to view; works in flat & XR) -->
<div id="mr-overlay" class="mr-ui" aria-live="polite">
  <header class="mr-topbar">
    <div class="mr-brand">XR Shop</div>
    <div class="mr-actions">
      <button class="mr-btn ghost" id="mrVoice"><span>ðŸŽ¤</span> Talk</button>
      <button class="mr-btn solid" id="mrCheckout"><span>ðŸ›’</span> Checkout</button>
    </div>
  </header>

  <section class="mr-grid" id="mrGrid" role="list"></section>

  <aside class="mr-cart" id="mrCart" aria-label="Cart">
    <h3>Cart</h3>
    <ul class="mr-cart-list" id="mrCartList"></ul>
    <div class="mr-cart-total"><span>Total</span><strong id="mrTotal">$0.00</strong></div>
  </aside>
</div>

  <a-scene renderer="colorManagement: true" environment="preset: default; skyType:none; ground: flat">

    <a-assets>
      <!-- Your GLB (re-export to metal/rough if you can) -->
      <a-asset-item id="assistant-gltf" src="assets/character.glb"></a-asset-item>
    </a-assets>

    <!-- Camera with mouse ray + whitelist -->
    <a-entity id="rig">
      <a-entity id="camera" camera position="0 1.6 0" look-controls
                cursor="rayOrigin: mouse"
                raycaster="objects: .ray"></a-entity>
    </a-entity>

    <!-- Assistant (left) -->
    <a-entity id="assistant"
              position="-1 0 -2.2"
              gltf-model="#assistant-gltf"
              animation-mixer="crossFadeDuration: 0.4"
              assistant-anim="idle: Idle; speaking: Walking; listening: Idle"
              speech-input
              speech-output
              assistant-brain="endpoint: api/ai-chat; system: You are a helpful VR shop guide. Be concise (<= 2 sentences).">
    </a-entity>

    <!-- Status HUD -->
    <a-entity id="status-text" position="0 2.2 -2" text="value: Press SPACE or click the assistant to talk.; align: center; color: #FFF"></a-entity>

    <!-- Shop grid (right) -->
    <a-entity id="shop"
              position="1 1.2 -2.2"
              shop-grid="src: assets/catalog.json; columns: 3; spacing: 0.42; width: 0.38; height: 0.38">
    </a-entity>

    <!-- Cart panel (right, above grid) -->
    <a-entity id="cart"
              position="1 2.1 -2.2"
              shop-cart="width: 1.2; height: 0.55">
    </a-entity>

  </a-scene>
</body>
</html>
